闪电网络简介

比特币的区块链存在可扩展性问题。

虽然Visa平均每秒处理2000笔交易，但比特币每秒只能处理7笔交易，区块容量为 1 MB。

比特币的闪电网络正致力于解决这一可扩展性问题。

比特币区块链的顶层

闪电网络背后所隐藏的构思是，较小的日常碎片化交易不需要存储在比特币主区块链上。

闪电网络是建立在比特币主区块链之上的第二层。 它使用“链下支付通道”以实现更快的微交易。

使用这种离线方法，被认为不太重要或外围的交易是在主链之外完成的。

基于闪电网络的链下交易仅在 2 个方面涉及比特币主区块链 —— 其一用于在双方之间开启私人'支付通道'，另一个则用于关闭通道。 

支付通道是两个用户之间的隐私通道，允许他们进行链下交易。

由于双方签署的最新资产负债表用于通过主链交易来关闭隐私通道，因此维持了支付的完整性(integrity of payment)。

闪电网示例 - 两个缔约方

为了更好地了解闪电网络,假设用户每天都在同一个自助餐厅吃午餐。

用户和餐厅互相信任彼此，因此用户和餐厅每天产生的交易不需要被记录在主区块链上。

相反，用户和餐厅将一定数量的比特币存入“多重签名账户”

即 用户 — 1 BTC

   餐厅 — 0 BTC

此交易记录在主区块链上。

现在用户有一个私人的链下通道与自助餐厅进行交易。 

使用多重签名账户资金的交易只能在双方同意的情况下进行。

第二天，用户订购 0.01 BTC的午餐

用户和餐厅都使用用户的私钥签署此交易。 

此交易记录在隐私通道上，多重签名账户现在的余额如下所示：

用户 — 0.99 BTC

餐厅 0.01 BTC

用户或自助餐厅可以随时关闭支付通道。 

用户仅仅需要展示最后的双方资产负债表(latest balance sheet) 并在比特币主网上广播
隐私通道通过一项交易来关闭，并且该交易将资金分配到比特币主区块链上的账户。

闪电网络的多方网络效应

除此之外，闪电网络还可以实现多方网络效应。 
以前面的例子举例，假设用户有两个独立的隐私链下通道：一个在用户和餐厅之间，另一个是来往密切的同事。

有一天，同事陪你去食堂吃午饭，并且她也想在自助餐厅吃午饭。 
她可以使用用户的多重签名账户作为她和自助餐厅之间的中间人，而不是开启自己的隐私通道。

如果在自助餐厅和同事之间有多个人拥有多个签名账户，那么支付通道会通过尽量短的路径来为用户的同事进行支付，即交易可以在连接的支付通道间跳转。

可扩展性一直是比特币主链面临的主要问题。

面对来自EOS，Qtum，以太坊和其他公司的竞争，闪电网络是比特币努力通过链下进行大量交易来解决可扩展性，从而减少比特币主区块链的负担。
闪电网络是一项亟需的技术，旨在解决最古老，最成熟和最知名的公共区块链的可扩展性问题。
